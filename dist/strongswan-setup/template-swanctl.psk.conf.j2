connections {
    gw-gw-{{ conn.name }} {
      local_addrs  = {{ conn.localPublicIp }}
      remote_addrs = {{ conn.remotePublicIp }}
      local {
         auth = {{ conn.auth }}
         id = {{ conn.localCN }
      }
      remote {
         auth = {{ conn.auth }}
         id = {{ conn.remoteCN }}
      }
      children {
         net-net {
            local_ts = {{ conn.localPrivateCidrs }}
            remote_ts = {{ conn.remotePrivateCidrs }}

            updown = /usr/local/libexec/ipsec/_updown iptables
            rekey_time = 5400
            rekey_bytes = 500000000
            rekey_packets = 1000000
            esp_proposals = {{ conn.proposals }}
         }
      }
      version = {{ conn.ikeVersion }}
      mobike = no
      reauth_time = 10800
      proposals = {{ conn.proposals }}
   }
}

secrets {
   ike-1 {
      id-1 = {{ conn.localCN }
      secret = {{ conn.localPSK }}
   }
   ike-2 {
      id-2 = {{ conn.remoteCN }}
      secret = {{ conn.remotePSK }}
   }
}