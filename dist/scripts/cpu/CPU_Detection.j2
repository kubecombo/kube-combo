{
  "nodename": "{{ NodeName }}",
  "timestamp": "{{ Time }}",
  "CPU": [{%- set sections = [] %}{# 1. CPU型号检测 #}{% if cpu_model_results %}{% set _ = sections.append({
    "detection": "CPU MODEL",
    "description": "显示 CPU 的具体型号，反映其基本性能参数（如核心数、线程数、基础频率），是评估主机处理能力的核心基础信息。",
    "results": cpu_model_results
  }) %}{% endif %}{# 2. 物理CPU使用率检测 #}{% if cpu_usage_results %}{% set _ = sections.append({
    "detection": "CPU USAGE RATE (PHYSICAL)",
    "description": "监测物理 CPU 核心的使用率，若单核心使用率持续达到 90% 及以上，表明 CPU 负载过高。",
    "results": cpu_usage_results
  }) %}{% endif %}{# 3. CPU温度检测 #}{% if cpu_temp_results %}{% set _ = sections.append({
    "detection": "CPU TEMPERATURE DETECTION (ALARM)",
    "description": "实时监测 CPU 温度，默认报警阈值为连续 10 分钟超过 90℃）。",
    "results": cpu_temp_results
  }) %}{% endif %}{# 4. CPU高频报警检测 #}{% if CPUFrequencyHigh_results %}{% set _ = sections.append({
    "detection": "CPU FREQUENCY HIGH ALARM",
    "description": "监测 CPU 核心频率是否超出动态最大频率的 90%（持续 10 分钟触发报警）。",
    "results": CPUFrequencyHigh_results
  }) %}{% endif %}{# 5. 1分钟CPU负载检测 #}{% if CPUload1_results %}{% set _ = sections.append({
    "detection": "CPU 1-MINUTE LOAD ALARM",
    "description": "监测主机 1 分钟 CPU 负载，若超出核心数的 1.5 倍（持续 2 分钟触发报警）。",
    "results": CPUload1_results
  }) %}{% endif %}{# 6. 5分钟CPU负载检测 #}{% if CPUload5_results %}{% set _ = sections.append({
    "detection": "CPU 5-MINUTE LOAD ALARM",
    "description": "监测主机 5 分钟 CPU 负载，若超出核心数的 1.2 倍（持续 5 分钟触发报警）。",
    "results": CPUload5_results
  }) %}{% endif %}{# 7. 15分钟CPU负载检测 #}{% if CPUload15_results %}{% set _ = sections.append({
    "detection": "CPU 15-MINUTE LOAD ALARM",
    "description": "监测主机 15 分钟 CPU 负载，若超出核心数的 1.0 倍（持续 15 分钟触发报警）。",
    "results": CPUload15_results
  }) %}{% endif %}
    {%- for section in sections %}
    {
      "detection": "{{ section.detection }}",
      "description": "{{ section.description }}",
      "results": [
        {%- for result in section.results %}
        {
          "key": "{{ result.key }}",
          "value": "{{ result.value }}",
          "err": "{{ result.err }}"
        }{% if not loop.last %},{% endif %}
        {%- endfor %}
      ]
    }{% if not loop.last %},{% endif %}
    {%- endfor %}
  ]
}
