{
  "nodename": "{{ nodename }}",
  "timestamp": "{{ timestamp }}",
  "CPU": [
    {%- set sections = [] %}

    {%- if cpu_model_results %}
      {%- set _ = sections.append({
        "detection": "CPU MODEL",
        "description": "A type of CPU model used in the system.",
        "results": cpu_model_results
      }) %}
    {%- endif %}

    {%- if cpu_usage_results %}
      {%- set _ = sections.append({
        "detection": "CPU USAGE",
        "description": "The current CPU usage percentage.",
        "results": cpu_usage_results
      }) %}
    {%- endif %}

    {%- if cpu_temp_results %}
      {%- set _ = sections.append({
        "detection": "CPU TEMPERATURE",
        "description": "The current temperature of the CPU in degrees Celsius.",
        "results": cpu_temp_results
      }) %}
    {%- endif %}

    {%- for section in sections %}
    {
      "detection": "{{ section.detection }}",
      "description": "{{ section.description }}",
      "status": "true",
      "results": [
        {%- for result in section.results %}
        {
          "key": "{{ result.key }}",
          "value": "{{ result.value }}",
          "err": "{{ result.err }}"
          "level": "{{ result.level }}"
        }{% if not loop.last %},{% endif %}
        {%- endfor %}
      ]
    }{% if not loop.last %},{% endif %}
    {%- endfor %}
  ]
}
