# 由于 vpc 内部的资源不方便基于 pod readiness 来做应用层健康检查，所以这里使用 keepalived 的脚本来做健康检查
# 每种业务都必须单独维护一个应用层检查的脚本以确保业务仍在正常运行

vrrp_script check_alive {
    script "/check_alive.sh"
    interval 2
    fall 2
    rise 10
}

vrrp_instance kolla_internal_vip_{{ keepalived_virtual_router_id }} {
    state BACKUP
    nopreempt
    interface eth0
    virtual_router_id {{ keepalived_virtual_router_id }}
    priority {{ keepalived_priority }}
    advert_int 1
    virtual_ipaddress {
        {{ kolla_internal_vip_address }} dev eth0
